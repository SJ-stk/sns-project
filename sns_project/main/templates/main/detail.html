{% extends 'base.html' %}
{% load static %}

{% block content %}
<section class="pagesec">
    <h1>{{post.title}}</h1>
    {% if post.writer %}
        {% if 'user' in post.writer.username %}
            작성자 : <a href="{%url 'users:mypage' post.writer.id%}">{{ post.writer.last_name }} {{ post.writer.first_name }}</a>
        {% else %}
            작성자 : <a href="{%url 'users:mypage' post.writer.id%}">{{ post.writer }}</a>
        {% endif %}
    {% else %}
        작성자 : 알 수 없음
    {% endif %}
    <hr>
    {% if post.image%}
        <p style="display:flex; justify-content: center;">
            <img src="{{ post.image.url }}"  style="width:60%;" alt="사진 나올 곳">
        </p>
    {% endif %}
    <p>{{post.body}}</p>
    {%if request.user == post.writer%}
        <a href="{%url 'main:edit' post.id %}" class="btn_post">수정하기</a>
        <a href="{%url 'main:delete' post.id %}" class="btn_post">삭제하기</a>
    {%endif%}
    <hr>
    <h5>Comments</h5>
    {%if user.is_authenticated%}
    <div>
        <form action="{%url 'main:create_comment' post.id%}" method="POST">
            {%csrf_token%}
            <textarea name="content" placeholder="댓글내용입력"></textarea>
            <input type="submit" value="확인">
        </form>
    </div>
    {%endif%}

    <div>
        {%for comment in comments%}
        <div>
            {% if comment.writer %}
                {% if 'user' in comment.writer.username %}
                    작성자 : {{ comment.writer.last_name }} {{ comment.writer.first_name }}
                {% else %}
                    작성자 : <a href="{%url 'users:mypage' comment.writer.id%}">{{ comment.writer }}</a>
                {% endif %}
            {% else %}
                작성자 : 알 수 없음
            {% endif %}
            <br>
            댓글 내용:{{comment.content}}
            {%if comment.writer == request.user%}
                <a href="{%url 'main:edit_comment' comment.id %}" class="btn_post">댓글수정</a>
                <a href="{%url 'main:delete_comment' comment.id %}" class="btn_post">댓글삭제</a>
            {%endif%}
        </div><br>
        {%endfor%}
    </div>
</section>
{% endblock %}

